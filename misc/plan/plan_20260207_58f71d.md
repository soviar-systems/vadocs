# Plan: Docs Consistency Fixes + API Reference Section

## Context

vadocs v0.1.0 has a `docs/` directory with ADRs, a developer guide, and R&D notes. The existing docs have several inconsistencies (broken links, merge conflicts, stale paths). The empty `docs/API/` directory needs to be renamed to `docs/api/` and populated with a proper API reference inspired by psycopg3's approach, adapted for plain Markdown.

---

## Part 1: Fix Documentation Inconsistencies

### 1.1 Move `docs/rnd/move-to-repo.md` to ai_engineering_book and delete from vadocs

The file documents a one-time repo migration but is useful as a general guide for creating spoke packages.

- **Resolve merge conflicts** (lines 45-51 and 82-129), generalize the content (replace vadocs-specific details with placeholders like `<package_name>`)
- **Write to** `../ai_engineering_book/architecture/packages/creating_spoke_packages.md`
  - This directory already has `README.md` (hub-and-spoke overview) and `vadocs.md` (package spec)
- **Delete** `docs/rnd/move-to-repo.md` from vadocs
- **Fix link** in the guide: `/docs/poc.ipynb` → reference to package's own PoC

### 1.2 Fix broken ADR reference in `docs/developer_guide/04_development.md`

- **Line 42**: `{term}\`ADR-26030\`` → `{term}\`ADR-26001\``

### 1.3 Fix stale paths in `docs/adrs/adr_26001_dogfooding_self_documentation.md`

- **Line 42**: `/docs/for_developers/04_development.md` → `/docs/developer_guide/04_development.md`
- **Line 51**: `docs/for_developers/04_development.md` → `/docs/developer_guide/04_development.md`

### 1.4 Rename `docs/API/` → `docs/api/`

- `git mv docs/API docs/api` for consistency with other dirs (`adrs`, `developer_guide`, `rnd`)

---

## Part 2: Create API Reference

### Approach: Psycopg3-inspired, Markdown-native

Key patterns adapted from psycopg3's concrete API pages:

| Pattern | psycopg3 (Sphinx) | vadocs adaptation (Markdown) |
|---|---|---|
| Class header | `.. class:: Connection` with module path | `### class Document` with `Module: vadocs.core.models` |
| Method signature | Sphinx autodoc with `:param:` | Code block: `fix(document, config, dry_run=False) → SyncResult` |
| Parameters | `:param name:` directive | Bulleted list: `- **name** (`type`) — description` |
| Return type | `:rtype:` | Shown in signature after `→` |
| Cross-refs | `:ref:\`label\`` | Markdown links to developer guide |
| Grouping | Methods grouped semantically | Same — H3 headers group related methods |
| Admonitions | `.. note::` | `> **Note:**` blockquote |
| Prose ratio | ~40% prose / ~60% signatures | Same balance |

### File structure

```
docs/api/
├── index.md           # Landing page: overview, import reference, links
├── models.md          # Document, ValidationError, SyncField, SyncResult
├── parsing.md         # parse_frontmatter, extract_status, extract_section_content
├── validators.md      # Validator ABC, Protocol, all 4 built-in validators
├── fixers.md          # Fixer ABC, Protocol, SyncDirection, SyncFixer, AdrFixer
└── configuration.md   # load_config, config file format reference
```

5 content pages + 1 index. Organized by functional area (not source file), one page per pipeline stage.

### Page outlines

#### `index.md` — API Reference
- Title + intro (this is the reference; developer guide is the tutorial)
- Package structure — summary list linking to each subpage with module path and key symbols
- Quick import reference — `from vadocs import ...` with all public symbols
- Version note (v0.1.0, library-only)

#### `models.md` — Core Models
- Cross-ref → [Developer Guide: Data Models](/docs/developer_guide/02_data_models.md)
- 4 dataclasses: `Document`, `ValidationError`, `SyncField`, `SyncResult`
- Each: class header, attribute list (name, type, description), properties, usage note

#### `parsing.md` — Parsing Utilities
- Cross-ref → [Developer Guide: Architecture](/docs/developer_guide/01_architecture.md)
- Module constants: `FRONTMATTER_PATTERN`, `STATUS_SECTION_PATTERN`, `SECTION_HEADER_PATTERN`
- 3 functions: signature, parameters, return value, edge cases

#### `validators.md` — Validators
- Cross-ref → [Developer Guide: Plugins](/docs/developer_guide/03_plugins.md)
- Base classes: `Validator` ABC, `ValidatorProtocol`
- 4 built-in validators: name, supports(), checks performed, config keys, error types

#### `fixers.md` — Fixers
- Cross-ref → [Developer Guide: Plugins](/docs/developer_guide/03_plugins.md)
- Base classes: `Fixer` ABC, `FixerProtocol`
- `SyncDirection` enum
- 2 built-in fixers: name, supports(), fixes performed, config keys, dry_run contract

#### `configuration.md` — Configuration
- Cross-ref → [Developer Guide: Development](/docs/developer_guide/04_development.md)
- `load_config()` signature, params, raises
- Full config key reference (from `adr_config.yaml`)
- Future note: pyproject.toml in v0.2.0

### Cross-referencing strategy

**API → Developer Guide** (near top of each page): contextual link to the relevant guide section.

**Developer Guide → API** (add to existing pages):
- `01_architecture.md` → link to API index
- `02_data_models.md` → link to `api/models.md`
- `03_plugins.md` → links to `api/validators.md` and `api/fixers.md`
- `04_development.md` → link to `api/configuration.md`

### Top-level docs index

Create `docs/index.md` linking all sections: Developer Guide, API Reference, ADRs, R&D.

---

## Implementation order (atomic commits)

0. **Save this plan** to `misc/plan/plan_<date_hash>.md` (per CLAUDE.md convention)
1. `docs: move spoke package guide to ai_engineering_book and clean up vadocs`
   - Create generalized guide at `../ai_engineering_book/architecture/packages/creating_spoke_packages.md`
   - Delete `docs/rnd/move-to-repo.md` from vadocs
2. `fix: correct broken references in developer guide and ADR-26001`
   - Fix `{term}\`ADR-26030\`` → `{term}\`ADR-26001\`` in `04_development.md`
   - Fix `for_developers` → `developer_guide` in ADR-26001
3. `docs: rename API directory to lowercase`
   - `git mv docs/API docs/api`
4. `docs: add API reference index and core models`
   - `docs/api/index.md`, `docs/api/models.md`
5. `docs: add parsing and configuration API reference`
   - `docs/api/parsing.md`, `docs/api/configuration.md`
6. `docs: add validators and fixers API reference`
   - `docs/api/validators.md`, `docs/api/fixers.md`
7. `docs: add top-level docs index and cross-references`
   - `docs/index.md`
   - Add API links to developer guide pages (`01`-`04`)

---

## Key source files to reference

- `src/vadocs/__init__.py` — canonical list of all public symbols
- `src/vadocs/core/models.py` — dataclass definitions and docstrings
- `src/vadocs/core/parsing.py` — function signatures and regex patterns
- `src/vadocs/validators/base.py` — Validator ABC + Protocol
- `src/vadocs/validators/adr.py` — AdrValidator
- `src/vadocs/validators/frontmatter.py` — FrontmatterValidator
- `src/vadocs/validators/myst_glossary.py` — MystGlossaryValidator, AdrTermValidator
- `src/vadocs/fixers/base.py` — Fixer ABC + Protocol
- `src/vadocs/fixers/sync_fixer.py` — SyncFixer, SyncDirection
- `src/vadocs/fixers/adr_fixer.py` — AdrFixer
- `docs/adrs/adr_config.yaml` — full config key reference

## Verification

- All internal links resolve to existing files
- `uv run pytest` still passes (no source code changes)
- Every public symbol from `__init__.py` is documented in at least one API page
- No merge conflict markers remain in docs/
- `docs/api/` directory is lowercase
